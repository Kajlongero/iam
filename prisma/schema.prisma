generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["access_control", "management", "public", "security", "utils"]
}

model MethodPermission {
  methodId      Int         @map("method_id")
  permissionId  Int         @map("permission_id")
  applicationId Int         @map("application_id")
  createdAt     DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  application   Application @relation(fields: [applicationId], references: [id])
  method        Method      @relation(fields: [methodId], references: [id])
  permission    Permission  @relation(fields: [permissionId], references: [id])

  @@id([methodId, permissionId, applicationId])
  @@map("method_permissions")
  @@schema("access_control")
}

model Method {
  id                          Int                          @id @default(autoincrement())
  name                        String                       @db.VarChar(64)
  isActive                    Boolean                      @default(true) @map("is_active")
  description                 String?
  objectId                    Int                          @map("object_id")
  createdAt                   DateTime                     @default(now()) @map("created_at") @db.Timestamptz(6)
  methodPermissions           MethodPermission[]
  object                      Object                       @relation(fields: [objectId], references: [id])
  resourceServerObjectMethods ResourceServerObjectMethod[]

  @@unique([name, objectId])
  @@index([name], map: "idx_access_control_methods_name")
  @@map("methods")
  @@schema("access_control")
}

model Object {
  id                          Int                          @id @default(autoincrement())
  description                 String?
  name                        String                       @db.VarChar(64)
  isActive                    Boolean                      @default(true) @map("is_active")
  applicationId               Int                          @map("application_id")
  createdAt                   DateTime                     @default(now()) @map("created_at") @db.Timestamptz(6)
  methods                     Method[]
  application                 Application                  @relation(fields: [applicationId], references: [id])
  resourceServerObjectMethods ResourceServerObjectMethod[]
  resourceServerObjects       ResourceServerObject[]

  @@unique([name, applicationId])
  @@index([name], map: "idx_objects_name")
  @@index([applicationId], map: "idx_objects_application_id")
  @@map("objects")
  @@schema("access_control")
}

model PermissionAssignmentRule {
  permissionId       Int         @map("permission_id")
  applicationId      Int         @map("application_id")
  minimumOwnerRoleId Int         @map("minimum_owner_role_id")
  createdAt          DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  application        Application @relation(fields: [applicationId], references: [id])
  role               Role        @relation(fields: [minimumOwnerRoleId], references: [id])
  permission         Permission  @relation(fields: [permissionId], references: [id])

  @@id([permissionId, applicationId])
  @@index([minimumOwnerRoleId], map: "idx_pa_minimum_owner_role_id")
  @@map("permission_assignment_rules")
  @@schema("access_control")
}

model Permission {
  id                                   Int                                   @id @default(autoincrement())
  name                                 String                                @db.VarChar(128)
  description                          String?
  isEditable                           Boolean                               @default(true) @map("is_editable")
  isApiScope                           Boolean                               @default(false) @map("is_api_scope")
  applicationId                        Int?                                  @map("application_id")
  createdAt                            DateTime                              @default(now()) @map("created_at") @db.Timestamptz(6)
  methodPermissions                    MethodPermission[]
  permissionAssignmentRules            PermissionAssignmentRule[]
  permissionImportance                 PermissionImportance[]
  application                          Application?                          @relation(fields: [applicationId], references: [id], onDelete: Restrict)
  resourceServerConsumptionPermissions ResourceServerConsumptionPermission[]
  resourceServerExposedPermissions     ResourceServerExposedPermission[]
  resourceServerMaxAllowedScopes       ResourceServerMaxAllowedScope[]
  roleAuthorityRestrictions            RoleAuthorityRestrictions[]
  rolePermissions                      RolePermission[]
  authorizationCodeScopes              AuthorizationCodeScope[]

  @@unique([name, applicationId], map: "uix_permissions_name_app")
  @@index([applicationId], map: "idx_permission_application_id")
  @@map("permissions")
  @@schema("access_control")
}

model RolePermission {
  roleId        Int         @map("role_id")
  permissionId  Int         @map("permission_id")
  applicationId Int         @map("application_id")
  expiresAt     DateTime?   @map("expires_at") @db.Timestamptz(6)
  isActive      Boolean     @default(true) @map("is_active")
  isAssignable  Boolean     @default(true) @map("is_assignable")
  createdAt     DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  application   Application @relation(fields: [applicationId], references: [id])
  permission    Permission  @relation(fields: [permissionId], references: [id])
  role          Role        @relation(fields: [roleId], references: [id])

  @@id([roleId, permissionId, applicationId])
  @@index([permissionId], map: "idx_access_control_role_permission_permission_id")
  @@map("role_permissions")
  @@schema("access_control")
}

model Role {
  id                         Int                         @id @default(autoincrement())
  name                       String                      @db.VarChar(48)
  description                String?
  isDefault                  Boolean                     @default(false) @map("is_default")
  parentRoleId               Int?                        @map("parent_role_id")
  applicationId              Int?                        @map("application_id")
  createdAt                  DateTime                    @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt                  DateTime?                   @map("updated_at") @db.Timestamptz(6)
  deletedAt                  DateTime?                   @map("deleted_at") @db.Timestamptz(6)
  applicationRoleAssignments ApplicationRoleAssignment[]
  applicationUserRoles       ApplicationUserRole[]
  permissionAssignmentRules  PermissionAssignmentRule[]
  executingRestrictions      RoleAuthorityRestrictions[] @relation("ExecutingRoleRestrictions")
  targetRestrictions         RoleAuthorityRestrictions[] @relation("TargetRoleRestrictions")
  rolePermissions            RolePermission[]
  application                Application?                @relation(fields: [applicationId], references: [id], onDelete: Restrict)
  parentRole                 Role?                       @relation("RolesToRoles", fields: [parentRoleId], references: [id])
  childRoles                 Role[]                      @relation("RolesToRoles")

  @@unique([applicationId, name])
  @@map("roles")
  @@schema("access_control")
}

model Provider {
  id           Int      @id @default(autoincrement())
  name         String   @unique @db.VarChar(50)
  description  String?
  strategyType String   @map("strategy_type") @db.VarChar(24)
  clientId     String?  @map("client_id") @db.VarChar(255)
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  auth         Auth[]

  @@map("providers")
  @@schema("management")
}

model Status {
  id               Int               @id @default(autoincrement()) @db.SmallInt
  name             String?           @unique @db.VarChar(24)
  description      String?
  createdAt        DateTime          @default(now()) @map("created_at") @db.Timestamptz(6)
  applications     Application[]
  applicationUsers ApplicationUser[]

  @@index([name], map: "idx_status_name")
  @@map("status")
  @@schema("management")
}

model Auth {
  id                   BigInt    @id @default(autoincrement())
  email                String    @unique @db.VarChar(255)
  password             String?   @db.VarChar(255)
  lastLoginAt          DateTime? @map("last_login_at") @db.Timestamptz(6)
  lockedEndTime        DateTime? @map("locked_end_time") @db.Timestamptz(6)
  failedLoginAttempts  Int       @default(0) @map("failed_login_attempts")
  lastPasswordChangeAt DateTime? @map("last_password_change_at") @db.Timestamptz(6)
  userId               String    @map("user_id") @db.Uuid
  providerId           Int?      @map("provider_id") @db.SmallInt
  providerUniqueId     String?   @map("provider_unique_id") @db.VarChar(128)
  provider             Provider? @relation(fields: [providerId], references: [id], onDelete: Restrict)
  user                 User      @relation(fields: [userId], references: [id])
  sessions             Session[]

  @@unique([providerId, providerUniqueId])
  @@index([userId], map: "idx_auth_user_id")
  @@map("auth")
  @@schema("security")
}

model Session {
  id            BigInt      @default(autoincrement())
  authId        BigInt      @map("auth_id")
  isActive      Boolean     @default(true) @map("is_active")
  applicationId Int         @map("application_id")
  expiresAt     DateTime    @map("expires_at") @db.Timestamptz(6)
  validUntil    DateTime    @map("valid_until") @db.Timestamptz(6)
  lastUsedAt    DateTime    @default(now()) @map("last_used_at") @db.Timestamptz(6)
  refreshToken  String      @map("refresh_token") @db.VarChar(64)
  ipAddress     String      @map("ip_address") @db.Inet
  userAgent     String      @map("user_agent")
  createdAt     DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  application   Application @relation(fields: [applicationId], references: [id])
  auth          Auth        @relation(fields: [authId], references: [id])

  @@id([applicationId, id])
  @@index([applicationId, authId, refreshToken], map: "idx_sessions_auth_id_refresh_token")
  @@map("sessions")
  @@schema("security")
}

model User {
  id                   String                @id @db.Uuid
  isLocalPassword      Boolean               @default(false) @map("is_local_password")
  isEmailConfirmed     Boolean               @default(false) @map("is_email_confirmed")
  createdAt            DateTime              @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt            DateTime?             @map("updated_at") @db.Timestamptz(6)
  deletedAt            DateTime?             @map("deleted_at") @db.Timestamptz(6)
  applicationUserRoles ApplicationUserRole[]
  applications         Application[]
  applicationUsers     ApplicationUser[]
  auth                 Auth[]
  authorizationCodes   AuthorizationCode[]
  passwordResets       PasswordReset[]
  profile              Profile?

  @@map("users")
  @@schema("security")
}

model PasswordReset {
  id        Int      @id @default(autoincrement())
  userId    String   @map("user_id") @db.Uuid
  isUsed    Boolean  @default(false) @map("is_used")
  ipAddress String?  @map("ip_address") @db.Inet
  tokenHash String   @unique @map("token_hash") @db.VarChar(45)
  expiresAt DateTime @map("expires_at") @db.Timestamptz(6)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  user      User     @relation(fields: [userId], references: [id])

  @@index([tokenHash], map: "idx_password_resets_token_hash")
  @@index([userId], map: "idx_password_resets_user_id")
  @@map("password_resets")
  @@schema("security")
}

/// This table is a partition table and requires additional setup for migrations.
/// Visit https://pris.ly/d/partition-tables for more info.
model ApplicationRoleAssignment {
  id            Int         @id @default(autoincrement())
  roleId        Int         @map("role_id")
  applicationId Int         @map("application_id")
  createdAt     DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt     DateTime?   @map("updated_at") @db.Timestamptz(6)
  deletedAt     DateTime?   @map("deleted_at") @db.Timestamptz(6)
  application   Application @relation(fields: [applicationId], references: [id])
  role          Role        @relation(fields: [roleId], references: [id])

  @@unique([applicationId, roleId])
  @@map("application_role_assignments")
  @@schema("access_control")
}

model ApplicationUserRole {
  userId        String      @map("user_id") @db.Uuid
  roleId        Int         @map("role_id")
  applicationId Int         @map("application_id")
  createdAt     DateTime?   @default(now()) @map("created_at") @db.Timestamptz(6)
  application   Application @relation(fields: [applicationId], references: [id])
  role          Role        @relation(fields: [roleId], references: [id])
  user          User        @relation(fields: [userId], references: [id])

  @@id([userId, applicationId, roleId])
  @@map("application_user_roles")
  @@schema("access_control")
}

model PermissionImportance {
  permissionId              Int                       @map("permission_id")
  applicationId             Int                       @map("application_id")
  importanceLevelId         Int                       @map("importance_level_id") @db.SmallInt
  createdAt                 DateTime                  @default(now()) @map("created_at") @db.Timestamptz(6)
  application               Application               @relation(fields: [applicationId], references: [id])
  permissionImportanceLevel PermissionImportanceLevel @relation(fields: [importanceLevelId], references: [id])
  permission                Permission                @relation(fields: [permissionId], references: [id])

  @@id([permissionId, applicationId])
  @@index([importanceLevelId], map: "idx_permission_importance_level_id")
  @@map("permission_importance")
  @@schema("access_control")
}

model PermissionImportanceLevel {
  id                   Int                    @id @default(autoincrement())
  name                 String                 @unique @db.VarChar(32)
  loggingPolicy        String                 @map("logging_policy") @db.VarChar(16)
  description          String?
  createdAt            DateTime               @default(now()) @map("created_at") @db.Timestamptz(6)
  permissionImportance PermissionImportance[]

  @@map("permission_importance_levels")
  @@schema("access_control")
}

model ResourceServerObjectMethod {
  id               Int            @id @default(autoincrement())
  isActive         Boolean        @default(true) @map("is_active")
  objectId         Int            @map("object_id")
  methodId         Int            @map("method_id")
  applicationId    Int            @map("application_id")
  resourceServerId Int            @map("resource_server_id")
  createdAt        DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  application      Application    @relation(fields: [applicationId], references: [id])
  method           Method         @relation(fields: [methodId], references: [id])
  object           Object         @relation(fields: [objectId], references: [id])
  resourceServer   ResourceServer @relation(fields: [resourceServerId], references: [id])

  @@unique([applicationId, resourceServerId, objectId, methodId], map: "resource_server_object_method_application_id_resource_serve_key")
  @@map("resource_server_object_methods")
  @@schema("access_control")
}

model ResourceServerObject {
  id               Int            @id @default(autoincrement())
  isActive         Boolean        @default(true) @map("is_active")
  objectId         Int            @map("object_id")
  applicationId    Int            @map("application_id")
  resourceServerId Int            @map("resource_server_id")
  createdAt        DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  application      Application    @relation(fields: [applicationId], references: [id])
  object           Object         @relation(fields: [objectId], references: [id])
  resourceServer   ResourceServer @relation(fields: [resourceServerId], references: [id])

  @@unique([applicationId, resourceServerId, objectId])
  @@map("resource_server_objects")
  @@schema("access_control")
}

model Application {
  id                                   Int                                   @id @default(autoincrement())
  url                                  String
  name                                 String                                @db.VarChar(96)
  slug                                 String                                @unique @db.VarChar(128)
  clientId                             String                                @unique @map("client_id") @db.VarChar(96)
  clientSecret                         String                                @map("client_secret") @db.VarChar(255)
  redirectUrl                          String                                @map("redirect_url") @db.VarChar(255)
  statusId                             Int                                   @map("status_id") @db.SmallInt
  creatorUserId                        String                                @map("creator_user_id") @db.Uuid
  createdAt                            DateTime                              @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt                            DateTime?                             @map("updated_at") @db.Timestamptz(6)
  deletedAt                            DateTime?                             @map("deleted_at") @db.Timestamptz(6)
  applicationRoleAssignments           ApplicationRoleAssignment[]
  applicationUserRoles                 ApplicationUserRole[]
  methodPermissions                    MethodPermission[]
  objects                              Object[]
  permissionAssignmentRules            PermissionAssignmentRule[]
  permissionImportance                 PermissionImportance[]
  permissions                          Permission[]
  resourceServerConsumptionPermissions ResourceServerConsumptionPermission[]
  resourceServerExposedPermissions     ResourceServerExposedPermission[]
  resourceServerMaxAllowedScopes       ResourceServerMaxAllowedScope[]
  resourceServerObjectMethods          ResourceServerObjectMethod[]
  resourceServerObjects                ResourceServerObject[]
  roleAuthorityRestrictions            RoleAuthorityRestrictions[]
  rolePermissions                      RolePermission[]
  roles                                Role[]
  creatorUser                          User                                  @relation(fields: [creatorUserId], references: [id])
  status                               Status                                @relation(fields: [statusId], references: [id])
  resourceServers                      ResourceServer[]
  applicationUsers                     ApplicationUser[]
  authorizationCodes                   AuthorizationCode[]
  sessions                             Session[]

  @@index([clientId], map: "idx_applications_client_id")
  @@index([url], map: "idx_applications_url")
  @@index([slug], map: "idx_applications_slug")
  @@map("applications")
  @@schema("management")
}

/// This table is a partition table and requires additional setup for migrations.
/// Visit https://pris.ly/d/partition-tables for more info.
model ResourceServer {
  id                             Int                                   @id @default(autoincrement())
  name                           String                                @db.VarChar(96)
  slug                           String                                @unique @db.VarChar(128)
  clientId                       String                                @map("client_id") @db.VarChar(96)
  clientSecret                   String                                @map("client_secret") @db.VarChar(255)
  isActive                       Boolean                               @default(true) @map("is_active")
  isGateway                      Boolean                               @default(false) @map("is_gateway")
  applicationId                  Int                                   @map("application_id")
  createdAt                      DateTime                              @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt                      DateTime?                             @map("updated_at") @db.Timestamptz(6)
  receivedConsumptionPermissions ResourceServerConsumptionPermission[] @relation("ResourceServerReceivedConsumptionPermissions")
  sentConsumptionPermissions     ResourceServerConsumptionPermission[] @relation("ResourceServerSentConsumptionPermissions")
  exposedPermissions             ResourceServerExposedPermission[]
  maxAllowedScopes               ResourceServerMaxAllowedScope[]
  resourceServerObjectMethods    ResourceServerObjectMethod[]
  resourceServerObjects          ResourceServerObject[]
  application                    Application                           @relation(fields: [applicationId], references: [id])

  @@unique([applicationId, name])
  @@index([slug], map: "idx_resource_servers_slug")
  @@map("resource_servers")
  @@schema("management")
}

/// This table is a partition table and requires additional setup for migrations.
/// Visit https://pris.ly/d/partition-tables for more info.
model ApplicationUser {
  userId        String      @map("user_id") @db.Uuid
  applicationId Int         @map("application_id")
  statusId      Int         @map("status_id") @db.SmallInt
  username      String      @db.VarChar(64)
  createdAt     DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  application   Application @relation(fields: [applicationId], references: [id])
  status        Status      @relation(fields: [statusId], references: [id])
  user          User        @relation(fields: [userId], references: [id])

  @@id([userId, applicationId])
  @@unique([applicationId, username])
  @@map("application_users")
  @@schema("security")
}

model Profile {
  userId      String    @id @map("user_id") @db.Uuid
  firstName   String    @map("first_name") @db.VarChar(128)
  lastName    String?   @map("last_name") @db.VarChar(128)
  phoneNumber String?   @map("phone_number") @db.VarChar(32)
  address     String?
  dateOfBirth DateTime? @map("date_of_birth") @db.Date
  createdAt   DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt   DateTime? @map("updated_at") @db.Timestamptz(6)
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("profiles")
  @@schema("security")
}

model ResourceServerConsumptionPermission {
  clientResourceServerId   Int            @map("client_resource_server_id")
  receptorResourceServerId Int            @map("receptor_resource_server_id")
  permissionId             Int            @map("permission_id")
  applicationId            Int            @map("application_id")
  isActive                 Boolean        @default(true) @map("is_active")
  createdAt                DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  receptorResourceServer   ResourceServer @relation("ResourceServerReceivedConsumptionPermissions", fields: [receptorResourceServerId], references: [id], map: "resource_server_consumption_pe_receptor_resource_server_id_fkey")
  clientResourceServer     ResourceServer @relation("ResourceServerSentConsumptionPermissions", fields: [clientResourceServerId], references: [id], map: "resource_server_consumption_perm_client_resource_server_id_fkey")
  application              Application    @relation(fields: [applicationId], references: [id])
  permission               Permission     @relation(fields: [permissionId], references: [id])

  @@id([clientResourceServerId, receptorResourceServerId, permissionId, applicationId])
  @@index([applicationId], map: "idx_consumption_application")
  @@index([receptorResourceServerId], map: "idx_consumption_receptor")
  @@map("resource_server_consumption_permissions")
  @@schema("access_control")
}

model ResourceServerExposedPermission {
  receptorResourceServerId Int            @map("receptor_resource_server_id")
  permissionId             Int            @map("permission_id")
  applicationId            Int            @map("application_id")
  isActive                 Boolean        @default(true) @map("is_active")
  createdAt                DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  resourceServer           ResourceServer @relation(fields: [receptorResourceServerId], references: [id], map: "resource_server_exposed_permis_receptor_resource_server_id_fkey")
  application              Application    @relation(fields: [applicationId], references: [id])
  permission               Permission     @relation(fields: [permissionId], references: [id])

  @@id([receptorResourceServerId, permissionId, applicationId])
  @@map("resource_server_exposed_permissions")
  @@schema("access_control")
}

model ResourceServerMaxAllowedScope {
  permissionId     Int            @map("permission_id")
  applicationId    Int            @map("application_id")
  resourceServerId Int            @map("resource_server_id")
  isActive         Boolean        @default(true) @map("is_active")
  createdAt        DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  application      Application    @relation(fields: [applicationId], references: [id])
  permission       Permission     @relation(fields: [permissionId], references: [id])
  resourceServer   ResourceServer @relation(fields: [resourceServerId], references: [id])

  @@id([resourceServerId, permissionId, applicationId])
  @@map("resource_server_max_allowed_scopes")
  @@schema("access_control")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
model RoleAuthorityRestrictions {
  permissionId    Int         @map("permission_id")
  applicationId   Int         @map("application_id")
  targetRoleId    Int         @map("target_role_id")
  executingRoleId Int         @map("executing_role_id")
  isAllowed       Boolean     @default(true) @map("is_allowed")
  createdAt       DateTime?   @default(now()) @map("created_at") @db.Timestamptz(6)
  applications    Application @relation(fields: [applicationId], references: [id], onDelete: Cascade)
  executingRole   Role        @relation("ExecutingRoleRestrictions", fields: [executingRoleId], references: [id], onDelete: Cascade)
  permissions     Permission  @relation(fields: [permissionId], references: [id], onDelete: Cascade)
  targetRole      Role        @relation("TargetRoleRestrictions", fields: [targetRoleId], references: [id], onDelete: Cascade)

  @@id([executingRoleId, targetRoleId, permissionId, applicationId])
  @@map("role_authority_restrictions")
  @@schema("access_control")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
model AuthorizationCodeScope {
  permissionId        Int               @map("permission_id")
  applicationId       Int               @map("application_id")
  authorizationCodeId String            @map("authorization_code_id") @db.VarChar(255)
  createdAt           DateTime          @default(now()) @map("created_at") @db.Timestamptz(6)
  authorizationCode   AuthorizationCode @relation(fields: [authorizationCodeId, applicationId], references: [code, applicationId], onDelete: Cascade)
  permission          Permission        @relation(fields: [permissionId], references: [id])

  @@id([authorizationCodeId, permissionId, applicationId])
  @@index([permissionId], map: "idx_auth_code_scopes_permission")
  @@map("authorization_code_scopes")
  @@schema("security")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
model AuthorizationCode {
  code                    String                   @db.VarChar(255)
  applicationId           Int                      @map("application_id")
  userId                  String                   @map("user_id") @db.Uuid
  isUsed                  Boolean                  @default(false) @map("is_used")
  ipAddress               String?                  @map("ip_address") @db.Inet
  userAgent               String?                  @map("user_agent")
  redirectUri             String                   @map("redirect_uri")
  codeChallenge           String?                  @map("code_challenge") @db.VarChar(255)
  codeChallengeMethod     String?                  @default("S256") @map("code_challenge_method") @db.VarChar(10)
  expiresAt               DateTime                 @map("expires_at") @db.Timestamptz(6)
  createdAt               DateTime                 @default(now()) @map("created_at") @db.Timestamptz(6)
  authorizationCodeScopes AuthorizationCodeScope[]
  application             Application              @relation(fields: [applicationId], references: [id], onDelete: Cascade)
  user                    User                     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([code, applicationId])
  @@index([userId], map: "idx_auth_codes_user_id")
  @@map("authorization_codes")
  @@schema("security")
}
